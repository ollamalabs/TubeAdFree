"use strict";function JPFR(e="",t="",...r){const s=safeSelf(),n=s.makeLogPrefix("json-prune-fetch-response",e,t),o=s.getExtraArgs(Array.from(arguments),2),c=createPropertyMatchMap(o.propsToMatch,"url"),a=s.initPattern(o.stackToMatch||"",{canNegate:!0}),u=""===e;self.fetch=new Proxy(self.fetch,{apply(r,l,p){const f=Reflect.apply(r,l,p);let h=u?"nomatch":"match";if(0!==c.size){const e=[p[0]instanceof Object?p[0]:{url:p[0]}];if(e[0]instanceof Request)try{e[0]=s.Request_clone.call(e[0])}catch(e){s.stndzErr(n,"Error:",e)}p[1]instanceof Object&&e.push(p[1]),doesObjectMatchProperties(c,...e)||(h="nomatch")}return u||"nomatch"!==h?(s.logLevel>1&&"nomatch"!==h&&0!==c.size&&s.stndzLog(n,`Matched optional "propsToMatch"\n${o.propsToMatch}`),f.then(r=>r.clone().json().then(o=>{if("object"!=typeof o)return r;if(u)return s.stndzLog(n,s.JSON_stringify(o,null,2)),r;const c=pruneObject(o,e,t,a);if("object"!=typeof c)return r;s.stndzLog(n,"Pruned");const l=Response.json(c,{status:r.status,statusText:r.statusText,headers:r.headers});return Object.defineProperties(l,{ok:{value:r.ok},redirected:{value:r.redirected},type:{value:r.type},url:{value:r.url}}),l}).catch(e=>(s.stndzErr(n,"Error:",e),r))).catch(e=>(s.stndzErr(n,"Error:",e),f))):f}})}