!(function(){"use strict";async function e(e){try{const t=e?{enableRulesetIds:["ad-blocking-rules"],disableRulesetIds:[]}:{enableRulesetIds:[],disableRulesetIds:["ad-blocking-rules"]};await chrome.declarativeNetRequest.updateEnabledRulesets(t)}catch(e){}}async function t(){return(await chrome.storage.sync.get(["adBlockStats"])).adBlockStats||{enabled:!0,totalBlocked:0,todayBlocked:0,lastResetDate:(new Date).toDateString(),installDate:Date.now(),lastUpdate:Date.now()}}async function a(){const e=await t();if(!e.enabled)return;const a=(new Date).toDateString();e.lastResetDate!==a&&(e.todayBlocked=0,e.lastResetDate=a),e.totalBlocked++,e.todayBlocked++,e.lastUpdate=Date.now(),await chrome.storage.sync.set({adBlockStats:e}),chrome.action.setBadgeText({text:e.todayBlocked.toString()}),chrome.action.setBadgeBackgroundColor({color:"#e52d28"}),chrome.runtime.sendMessage({action:"statsUpdated",stats:e}).catch(()=>{})}importScripts("./browser-compat.js","./browser-script.js","./browser-module.js"),chrome.runtime.onMessage.addListener((o,s,n)=>{if("toggleAdBlocker"===o.action)t().then(async t=>{t.enabled=o.enabled,chrome.storage.sync.set({adBlockStats:t}),await e(o.enabled),o.enabled?(chrome.action.setBadgeText({text:t.todayBlocked.toString()}),chrome.action.setBadgeBackgroundColor({color:"#e52d28"})):(chrome.action.setBadgeText({text:"OFF"}),chrome.action.setBadgeBackgroundColor({color:"#6c757d"}))});else if("adBlocked"===o.action){const e=o.count||1;(async()=>{for(let t=0;t<e;t++)await a()})()}}),chrome.runtime.onInstalled.addListener(function(t){"install"===t.reason?(chrome.storage.sync.set({installDate:Date.now(),showsharebtn:!0,adBlockStats:{enabled:!0,totalBlocked:0,todayBlocked:0,lastResetDate:(new Date).toDateString(),installDate:Date.now(),lastUpdate:Date.now()}}),chrome.action.setBadgeText({text:"0"}),chrome.action.setBadgeBackgroundColor({color:"#e52d28"})):"update"===t.reason&&(chrome.storage.sync.set({showsharebtn:!0}),chrome.storage.sync.get(["adBlockStats"],t=>{t.adBlockStats||chrome.storage.sync.set({adBlockStats:{enabled:!0,totalBlocked:0,todayBlocked:0,lastResetDate:(new Date).toDateString(),installDate:Date.now(),lastUpdate:Date.now()}}),e((t.adBlockStats||{enabled:!0}).enabled)}))})})();